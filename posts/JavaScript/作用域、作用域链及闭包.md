---
title: '''作用域、作用域链及闭包'''
date: 2017-08-14
tags:
---

### 作用域
   一个抽象的概念，用于隔离变量，在函数创建时产生的，作用域中变量的值是在执行过程中确定的，
包括全局作用域和函数作用域
这里eval作用域和ES6提供了块级作用域暂且不谈
    
### 作用域链与函数调用栈
  当代码在一个环境中执行时，会创建变量对象的一个作用域链（scope chain） 。作用域链是由一系列执行上下文中的活动对象加最后的全局对象组成的。作用域链的用途，是保证对执行环境有权访问的所有变量和函数的有序访问。每一个执行上下文可以访问的对象包括自身的作用域和上层执行上下文的作用域直到全局作用域，这就产生了作用域链。


### 闭包
可以在chrome开发者工具中查看闭包的调用，闭包的形成需要有两个条件:

  1.在函数内部创建新的函数    
  2.新的函数在执行时（不管是在当前作用域执行还是外部作用域执行），访问了函数的变量对象，除全局作用域外；

     var fn;
     var m=20;
     function A1(){
         var a = 1;
         var b = 2;
         var t = function(){
            return b;
         }
         t();                   //产生闭包，执行时访问了外部函数的变量
         function baz(a){
             console.log(a);
         }
         fn = baz;
     }

     function bar(){
         fn(m);         //不会产生闭包，输出全局作用域下的值20
     };
     var a2 = A1();
     bar();

 闭包的作用域链并不会发生任何改变，即使闭包在其他执行上下文环境中。在闭包中，能访问到的变量，仍然是作用域链上能够查询到的变量。

### 闭包的危害
每个执行上下文执行完毕后出栈被销毁，但是闭包阻止了这一行为。
闭包任然会访问这个上下文环境中的变量（即作用域链中的变量），所以该函数的执行上下文环境不能被销毁，使用闭包会增加内存开销。


### 闭包的应用场景
这里简单列举几个应用的场景

  1.函数柯里化<br/>
  2.dom事件绑定<br/>
  3.函数作为参数传递:延迟函数setTimeout 
  
    for (var i=1; i<=5; i++) {
        setTimeout( function timer() {
            console.log(i);
        }, i*1000 );
    }
    
  4.模块是闭包最强大的一个应用场景：闭包在jquery中应用很多
